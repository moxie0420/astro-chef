---
import { actions } from "astro:actions";
import { marked } from "marked";

import RecipeLayout from "@layouts/recipeLayout.astro";

const { title } = Astro.params;

const { data, error } = await Astro.callAction(actions.recipe.getRecipe, {
  title: title,
});

if (error?.code) return Astro.redirect("/404?message=" + error?.message);
else if (error) return Astro.redirect("/404?message=An Unkown Error Occured");

const md = await marked.parse(data?.body || "");
---

<RecipeLayout title={data?.title}>
  <article set:html={md} />
</RecipeLayout>
